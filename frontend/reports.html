  <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Poultry Farm Management</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-brand">
            <h2><i class="fas fa-egg"></i> PoultryPro Manager</h2>
        </div>
        <div class="nav-menu">
            <a href="dashboard.html" class="nav-link active">Dashboard</a>
            <a href="flock.html" class="nav-link">Flocks</a>
            <a href="feed.html" class="nav-link">Feed</a>
            <a href="sales.html" class="nav-link">Sales</a>
            <a href="expenses.html" class="nav-link">Expenses</a>
            <a href="reports.html" class="nav-link">Reports</a>
            <a href="profile.html" class="nav-link">Profile</a>
            <button id="logoutBtn" class="btn btn-outline">Logout</button>
        </div>
    </nav>
    <div class="container">
        <div class="page-header">
            <h1>Reports & Analytics</h1>
            <div class="header-actions">
                <button id="generateReportBtn" class="btn btn-primary">Generate Report</button>
                <button id="exportDataBtn" class="btn btn-secondary">Export Data</button>
            </div>
        </div>

        <!-- Report Filters -->
        <div class="report-filters">
            <div class="filter-card">
                <h3>Report Parameters</h3>
                <div class="filter-row">
                    <div class="form-group">
                        <label for="reportType">Report Type</label>
                        <select id="reportType" class="form-select">
                            <option value="profit_loss">Profit & Loss</option>
                            <option value="production">Production Summary</option>
                            <option value="feed_consumption">Feed Consumption</option>
                            <option value="sales_analysis">Sales Analysis</option>
                            <option value="expense_breakdown">Expense Breakdown</option>
                            <option value="flock_performance">Flock Performance</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="reportPeriod">Period</label>
                        <select id="reportPeriod" class="form-select">
                            <option value="custom">Custom Range</option>
                            <option value="today">Today</option>
                            <option value="yesterday">Yesterday</option>
                            <option value="this_week">This Week</option>
                            <option value="last_week">Last Week</option>
                            <option value="this_month">This Month</option>
                            <option value="last_month">Last Month</option>
                            <option value="this_quarter">This Quarter</option>
                            <option value="this_year">This Year</option>
                        </select>
                    </div>
                </div>

                <div class="filter-row" id="customDateRange">
                    <div class="form-group">
                        <label for="startDate">Start Date</label>
                        <input type="date" id="startDate" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="endDate">End Date</label>
                        <input type="date" id="endDate" class="form-input">
                    </div>
                </div>

                <div class="filter-row">
                    <div class="form-group">
                        <label for="flockFilter">Flock (Optional)</label>
                        <select id="flockFilter" class="form-select">
                            <option value="">All Flocks</option>
                            <!-- Options will be populated by JavaScript -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="exportFormat">Export Format</label>
                        <select id="exportFormat" class="form-select">
                            <option value="pdf">PDF</option>
                            <option value="excel">Excel</option>
                            <option value="csv">CSV</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- Report Content -->
        <div class="report-content">
            <div id="reportContainer" class="report-display">
                <!-- Default Dashboard Cards -->
                <div class="report-dashboard">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3>Key Performance Indicators</h3>
                        </div>
                        <div class="kpi-grid">
                            <div class="kpi-card">
                                <div class="kpi-value" id="totalRevenue">‚Çπ0</div>
                                <div class="kpi-label">Total Revenue</div>
                                <div class="kpi-change positive" id="revenueChange">+0%</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-value" id="totalExpenses">‚Çπ0</div>
                                <div class="kpi-label">Total Expenses</div>
                                <div class="kpi-change negative" id="expenseChange">+0%</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-value" id="netProfit">‚Çπ0</div>
                                <div class="kpi-label">Net Profit</div>
                                <div class="kpi-change positive" id="profitChange">+0%</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-value" id="profitMargin">0%</div>
                                <div class="kpi-label">Profit Margin</div>
                                <div class="kpi-change positive" id="marginChange">+0%</div>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3>Production Metrics</h3>
                        </div>
                        <div class="metrics-grid">
                            <div class="metric-item">
                                <span class="metric-label">Total Birds Sold</span>
                                <span class="metric-value" id="totalBirdsSold">0</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Average Price per Bird</span>
                                <span class="metric-value" id="avgPricePerBird">‚Çπ0</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Feed Conversion Ratio</span>
                                <span class="metric-value" id="feedConversionRatio">0:1</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Mortality Rate</span>
                                <span class="metric-value" id="mortalityRate">0%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts Section -->
                <div class="charts-section">
                    <div class="chart-card">
                        <div class="card-header">
                            <h3>Revenue vs Expenses Trend</h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="revenueExpenseChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-card">
                        <div class="card-header">
                            <h3>Expense Categories</h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="expenseCategoryChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="charts-section">
                    <div class="chart-card">
                        <div class="card-header">
                            <h3>Feed Consumption Trend</h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="feedConsumptionChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-card">
                        <div class="card-header">
                            <h3>Flock Performance</h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="flockPerformanceChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Reports -->
        <div class="quick-reports">
            <div class="section-header">
                <h3>Quick Reports</h3>
            </div>
            <div class="quick-reports-grid">
                <div class="quick-report-card" data-report="daily_summary">
                    <div class="report-icon">üìä</div>
                    <h4>Daily Summary</h4>
                    <p>Today's sales, expenses, and profit</p>
                    <button class="btn btn-sm btn-outline">Generate</button>
                </div>
                <div class="quick-report-card" data-report="weekly_performance">
                    <div class="report-icon">üìà</div>
                    <h4>Weekly Performance</h4>
                    <p>This week's performance metrics</p>
                    <button class="btn btn-sm btn-outline">Generate</button>
                </div>
                <div class="quick-report-card" data-report="monthly_pl">
                    <div class="report-icon">üí∞</div>
                    <h4>Monthly P&L</h4>
                    <p>Profit and loss statement</p>
                    <button class="btn btn-sm btn-outline">Generate</button>
                </div>
                <div class="quick-report-card" data-report="feed_analysis">
                    <div class="report-icon">üåæ</div>
                    <h4>Feed Analysis</h4>
                    <p>Feed consumption and costs</p>
                    <button class="btn btn-sm btn-outline">Generate</button>
                </div>
                <div class="quick-report-card" data-report="flock_summary">
                    <div class="report-icon">üêî</div>
                    <h4>Flock Summary</h4>
                    <p>Current flock status and health</p>
                    <button class="btn btn-sm btn-outline">Generate</button>
                </div>
                <div class="quick-report-card" data-report="tax_report">
                    <div class="report-icon">üìã</div>
                    <h4>Tax Report</h4>
                    <p>Income and expenses for tax filing</p>
                    <button class="btn btn-sm btn-outline">Generate</button>
                </div>
            </div>
        </div>

        <!-- Recent Reports -->
        <div class="recent-reports">
            <div class="section-header">
                <h3>Recent Reports</h3>
                <button id="clearHistoryBtn" class="btn btn-sm btn-outline">Clear History</button>
            </div>
            <div class="table-container">
                <table id="recentReportsTable" class="data-table">
                    <thead>
                        <tr>
                            <th>Report Name</th>
                            <th>Type</th>
                            <th>Period</th>
                            <th>Generated On</th>
                            <th>Size</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Recent reports will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Report Preview Modal -->
    <div id="reportPreviewModal" class="modal large">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="previewTitle">Report Preview</h2>
                <div class="modal-actions">
                    <button id="printReportBtn" class="btn btn-sm btn-secondary">Print</button>
                    <button id="downloadReportBtn" class="btn btn-sm btn-primary">Download</button>
                    <span class="close" id="closePreviewModal">&times;</span>
                </div>
            </div>
            <div class="modal-body">
                <div id="reportPreview" class="report-preview">
                    <!-- Report content will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Export Options Modal -->
    <div id="exportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Export Data</h2>
                <span class="close" id="closeExportModal">&times;</span>
            </div>
            <form id="exportForm" class="modal-body">
                <div class="form-group">
                    <label for="exportDataType">Data Type</label>
                    <select id="exportDataType" name="dataType" required>
                        <option value="">Select Data Type</option>
                        <option value="all">All Data</option>
                        <option value="flocks">Flocks</option>
                        <option value="sales">Sales</option>
                        <option value="expenses">Expenses</option>
                        <option value="feed">Feed Records</option>
                    </select>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="exportFromDate">From Date</label>
                        <input type="date" id="exportFromDate" name="fromDate">
                    </div>
                    <div class="form-group">
                        <label for="exportToDate">To Date</label>
                        <input type="date" id="exportToDate" name="toDate">
                    </div>
                </div>

                <div class="form-group">
                    <label for="exportFormatSelect">Export Format</label>
                    <select id="exportFormatSelect" name="format" required>
                        <option value="csv">CSV</option>
                        <option value="excel">Excel</option>
                        <option value="pdf">PDF</option>
                        <option value="json">JSON</option>
                    </select>
                </div>

                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" id="includeDeleted" name="includeDeleted">
                        <label for="includeDeleted">Include deleted records</label>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('exportModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Export Data</button>
                </div>
            </form>
        </div>
    </div>

    <div id="alertContainer"></div>
    
    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            initializeReports();
            loadReportData();
        });
    </script>
</body>
</html>